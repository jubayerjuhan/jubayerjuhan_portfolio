import Head from "next/head";
import { Inter } from "@next/font/google";
import { useState } from "react";
import Navbar from "../components/ui/Navbar/Navbar";
import Herosection from "../components/sections/Herosection/Herosection";
import MobileMenu from "@/components/ui/MobileMenu/MobileMenu";
import Emailelement from "../components/ui/Sideelements/Emailelement/Emailelement";
import SocialLinks from "../components/ui/Sideelements/SocialLinks/SocialLinks";
import About from "../components/sections/About/About";
import Work from "../components/sections/Work/Work";
import ThingsIBuilt from "../components/sections/ThingsIBuilt/ThingsIBuilt";
import OtherProjects from "../components/sections/OtherProjects/OtherProjects";
import Footer from "../components/sections/Footer/Footer";
import sanityClient from "../utils/sanityClient";
import { useDispatch } from "react-redux";
import { SITE_SETTINGS_FULLFILLED } from "@/redux/name_variables/reduxNameVariables";
import {
  experienceQuery,
  projectQuery,
  siteSettingsQuery,
} from "../utils/queries/homepageQueries";

const inter = Inter({ subsets: ["latin"] });
export default function Home(props: any) {
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
  const disatch = useDispatch();

  console.log(props.experiences);
  // dispatching site settings to redux
  disatch({
    type: SITE_SETTINGS_FULLFILLED,
    payload: {
      ...props?.siteSettings,
      experiences: props.experiences,
      projects: props.projects,
    },
  });

  return (
    <>
      <Head>
        <title>Jubayer Juhan</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main style={{ position: "relative" }}>
        <Navbar
          setMobileMenuOpen={setMobileMenuOpen}
          mobileMenuOpen={mobileMenuOpen}
        />
        <MobileMenu open={mobileMenuOpen} />
        {/* side elements*/}
        <Emailelement />
        <SocialLinks />
        <Herosection />
        <About />
        <Work />
        <ThingsIBuilt />
        <OtherProjects />
        <Footer />
      </main>
    </>
  );
}

export const getServerSideProps = async () => {
  const siteSettings = await sanityClient.fetch(siteSettingsQuery);
  const experiences = await sanityClient.fetch(experienceQuery);
  const projects = await sanityClient.fetch(projectQuery);
  return {
    props: { siteSettings, experiences, projects },
  };
};
